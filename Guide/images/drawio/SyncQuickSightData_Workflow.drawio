<mxfile host="app.diagrams.net">
  <diagram id="SyncQSDataWorkflow" name="Sync QuickSight Data Workflow">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- User Action -->
        <mxCell id="user-1" value="User clicks&#xa;'Sync Data'" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="40" y="40" width="140" height="60" as="geometry" />
        </mxCell>
        
        <!-- Step 1: Fetch Namespaces -->
        <mxCell id="step1" value="fetchNamespacesFromQS&#xa;List all QS Namespaces" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="30" y="140" width="180" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow1" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="user-1" target="step1">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Decision: Namespaces Found? -->
        <mxCell id="decision1" value="Namespaces&#xa;Found?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="60" y="240" width="120" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow1-1" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="step1" target="decision1">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Error Path 1 -->
        <mxCell id="error1" value="ERROR:&#xa;No namespaces&#xa;or access denied" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="260" y="250" width="130" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow-error1" value="No" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" edge="1" parent="1" source="decision1" target="error1">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Step 2: Save Namespaces -->
        <mxCell id="step2" value="Save to DynamoDB&#xa;Update Namespace table" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="40" y="360" width="160" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2" value="Yes" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="decision1" target="step2">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Step 3: Fetch Users -->
        <mxCell id="step3" value="fetchUsersFromQS&#xa;List all Users&#xa;(paginated)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="40" y="460" width="160" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow3" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="step2" target="step3">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Pagination Loop -->
        <mxCell id="pagination-users" value="Next Page?" style="endArrow=classic;html=1;exitX=0;exitY=0.5;entryX=0;entryY=0.5;rounded=1;dashed=1;" edge="1" parent="1" source="step3" target="step3">
          <mxGeometry x="-0.2" width="50" height="50" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <!-- Decision: Users Found? -->
        <mxCell id="decision3" value="Users&#xa;Found?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="60" y="570" width="120" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow3-1" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="step3" target="decision3">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Warning Path -->
        <mxCell id="warning3" value="WARNING:&#xa;No users found" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="260" y="580" width="120" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow-warning3" value="No" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;dashed=1;" edge="1" parent="1" source="decision3" target="warning3">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Step 4: Save Users -->
        <mxCell id="step4" value="Save to DynamoDB&#xa;Update UserGroup table" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="40" y="690" width="160" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow4" value="Yes" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="decision3" target="step4">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Continue to next column -->
        <mxCell id="connector1" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0;entryY=0.5;rounded=1;" edge="1" parent="1" source="step4" target="step5">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Step 5: Fetch Groups -->
        <mxCell id="step5" value="fetchGroupsFromQS&#xa;List all Groups&#xa;(paginated)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="480" y="40" width="160" height="70" as="geometry" />
        </mxCell>
        
        <!-- Pagination Loop Groups -->
        <mxCell id="pagination-groups" value="Next Page?" style="endArrow=classic;html=1;exitX=0;exitY=0.5;entryX=0;entryY=0.5;rounded=1;dashed=1;" edge="1" parent="1" source="step5" target="step5">
          <mxGeometry x="-0.2" width="50" height="50" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <!-- Decision: Groups Found? -->
        <mxCell id="decision5" value="Groups&#xa;Found?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="500" y="150" width="120" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow5-1" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="step5" target="decision5">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Warning Path Groups -->
        <mxCell id="warning5" value="WARNING:&#xa;No groups found" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="700" y="160" width="120" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow-warning5" value="No" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;dashed=1;" edge="1" parent="1" source="decision5" target="warning5">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Step 6: Save Groups -->
        <mxCell id="step6" value="Save to DynamoDB&#xa;Update UserGroup table" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="480" y="270" width="160" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow6" value="Yes" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="decision5" target="step6">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Step 7: Fetch DataSets -->
        <mxCell id="step7" value="fetchDataSetsFromQS&#xa;List all DataSets&#xa;(paginated)" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="480" y="370" width="160" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow7" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="step6" target="step7">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Pagination Loop DataSets -->
        <mxCell id="pagination-datasets" value="Next Page?" style="endArrow=classic;html=1;exitX=0;exitY=0.5;entryX=0;entryY=0.5;rounded=1;dashed=1;" edge="1" parent="1" source="step7" target="step7">
          <mxGeometry x="-0.2" width="50" height="50" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        
        <!-- Decision: DataSets Found? -->
        <mxCell id="decision7" value="DataSets&#xa;Found?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="500" y="480" width="120" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow7-1" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="step7" target="decision7">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Warning Path DataSets -->
        <mxCell id="warning7" value="WARNING:&#xa;No datasets found" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="700" y="490" width="120" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow-warning7" value="No" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;dashed=1;" edge="1" parent="1" source="decision7" target="warning7">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Step 8: Save DataSets -->
        <mxCell id="step8" value="Save to DynamoDB&#xa;Update DataSet table" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="480" y="600" width="160" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow8" value="Yes" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="decision7" target="step8">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Step 9: Update Account Details -->
        <mxCell id="step9" value="Update AccountDetails&#xa;Set counts &amp; timestamp" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="480" y="700" width="160" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow9" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="step8" target="step9">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Success -->
        <mxCell id="success" value="SUCCESS!&#xa;Data Synced&#xa;from QuickSight" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="260" y="710" width="150" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow-success" value="" style="endArrow=classic;html=1;exitX=0;exitY=0.5;entryX=1;entryY=0.5;rounded=1;" edge="1" parent="1" source="step9" target="success">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Legend -->
        <mxCell id="legend-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#666666;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="880" y="40" width="180" height="200" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-title" value="Legend" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="880" y="40" width="180" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-1" value="Lambda Function" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="890" y="80" width="160" height="25" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-2" value="Decision Point" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="930" y="115" width="80" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-3" value="Error State" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="890" y="165" width="160" height="25" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-4" value="Warning (Continue)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="890" y="200" width="160" height="25" as="geometry" />
        </mxCell>
        
        <!-- Notes -->
        <mxCell id="notes-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="880" y="260" width="180" height="240" as="geometry" />
        </mxCell>
        
        <mxCell id="notes-title" value="Notes:" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="890" y="270" width="160" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="notes-text" value="• Syncs data FROM&#xa;  QuickSight TO tool&#xa;&#xa;• Runs in sequence:&#xa;  Namespaces → Users&#xa;  → Groups → DataSets&#xa;&#xa;• Uses pagination for&#xa;  large datasets&#xa;&#xa;• Missing data shows&#xa;  warnings but doesn't&#xa;  stop sync&#xa;&#xa;• Updates timestamp&#xa;  in AccountDetails&#xa;&#xa;• Should be run&#xa;  periodically or when&#xa;  QS changes occur" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="890" y="295" width="160" height="195" as="geometry" />
        </mxCell>
        
        <!-- Sync Order -->
        <mxCell id="sync-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="880" y="520" width="180" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="sync-title" value="Sync Order:" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="890" y="530" width="160" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="sync-text" value="1. Namespaces&#xa;2. Users (per namespace)&#xa;3. Groups (per namespace)&#xa;4. DataSets&#xa;5. Account metadata&#xa;&#xa;This order ensures&#xa;referential integrity" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="890" y="555" width="160" height="95" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
