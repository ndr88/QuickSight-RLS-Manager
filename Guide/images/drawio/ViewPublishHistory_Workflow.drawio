<mxfile host="app.diagrams.net">
  <diagram id="ViewHistoryWorkflow" name="View Publish History Workflow">
    <mxGraphModel dx="1422" dy="794" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="827" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- User Action -->
        <mxCell id="user-1" value="User clicks&#xa;'View History'" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontStyle=1;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="40" y="40" width="140" height="60" as="geometry" />
        </mxCell>
        
        <!-- Get DataSet Info -->
        <mxCell id="get-ds" value="Get DataSet Info&#xa;from context" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="40" y="140" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow1" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="user-1" target="get-ds">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- List Versions -->
        <mxCell id="list-versions" value="listPublishHistory&#xa;Query S3 for all versions&#xa;of RLS CSV file" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="30" y="240" width="160" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="get-ds" target="list-versions">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Decision: Versions Found? -->
        <mxCell id="decision1" value="Versions&#xa;Found?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="50" y="350" width="120" height="80" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow3" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="list-versions" target="decision1">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- No History -->
        <mxCell id="no-history" value="Show Message:&#xa;'No publish history&#xa;available'" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="250" y="360" width="130" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow-no" value="No" style="endArrow=classic;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;" edge="1" parent="1" source="decision1" target="no-history">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Parse Metadata -->
        <mxCell id="parse" value="Parse Version Metadata&#xa;• Version ID&#xa;• Timestamp&#xa;• File size&#xa;• ETag/Checksum" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;align=left;" vertex="1" parent="1">
          <mxGeometry x="30" y="470" width="160" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow4" value="Yes" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="decision1" target="parse">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Enrich Data -->
        <mxCell id="enrich" value="Enrich with DB Data&#xa;• User who published&#xa;• Row count&#xa;• Permission count&#xa;• Notes/comments" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;align=left;" vertex="1" parent="1">
          <mxGeometry x="30" y="610" width="160" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow5" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="parse" target="enrich">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Continue to next column -->
        <mxCell id="connector1" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0;entryY=0.5;rounded=1;" edge="1" parent="1" source="enrich" target="sort">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Sort Versions -->
        <mxCell id="sort" value="Sort by Timestamp&#xa;Most recent first" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="480" y="40" width="160" height="60" as="geometry" />
        </mxCell>
        
        <!-- Format Display -->
        <mxCell id="format" value="Format for Display&#xa;• Relative time&#xa;  (2 hours ago)&#xa;• File size (MB)&#xa;• Status badges" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;align=left;" vertex="1" parent="1">
          <mxGeometry x="480" y="140" width="160" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow6" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="sort" target="format">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Display Table -->
        <mxCell id="display" value="Display History Table&#xa;Columns:&#xa;• Version&#xa;• Published Date&#xa;• Published By&#xa;• Row Count&#xa;• Size&#xa;• Actions" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;" vertex="1" parent="1">
          <mxGeometry x="480" y="280" width="160" height="140" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow7" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="format" target="display">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- User Actions -->
        <mxCell id="actions" value="Available Actions:&#xa;• View version details&#xa;• Download CSV&#xa;• Rollback to version&#xa;• Compare versions" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;" vertex="1" parent="1">
          <mxGeometry x="480" y="460" width="160" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow8" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="display" target="actions">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Success -->
        <mxCell id="success" value="SUCCESS!&#xa;History Displayed&#xa;User Can Take Action" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="485" y="600" width="150" height="70" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow-success" value="" style="endArrow=classic;html=1;exitX=0.5;exitY=1;entryX=0.5;entryY=0;" edge="1" parent="1" source="actions" target="success">
          <mxGeometry width="50" height="50" relative="1" as="geometry" />
        </mxCell>
        
        <!-- Legend -->
        <mxCell id="legend-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=none;strokeColor=#666666;dashed=1;" vertex="1" parent="1">
          <mxGeometry x="880" y="40" width="180" height="180" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-title" value="Legend" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=14;" vertex="1" parent="1">
          <mxGeometry x="880" y="40" width="180" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-1" value="Lambda Function" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="890" y="80" width="160" height="25" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-2" value="Decision Point" style="rhombus;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="930" y="115" width="80" height="40" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-3" value="UI Display" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="890" y="165" width="160" height="25" as="geometry" />
        </mxCell>
        
        <mxCell id="legend-4" value="User Action" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="890" y="200" width="160" height="25" as="geometry" />
        </mxCell>
        
        <!-- Notes -->
        <mxCell id="notes-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;align=left;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="880" y="240" width="180" height="220" as="geometry" />
        </mxCell>
        
        <mxCell id="notes-title" value="Notes:" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="890" y="250" width="160" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="notes-text" value="• Read-only view&#xa;&#xa;• Uses S3 versioning&#xa;  to track all publishes&#xa;&#xa;• Shows complete audit&#xa;  trail of changes&#xa;&#xa;• Each version includes:&#xa;  - When published&#xa;  - Who published&#xa;  - What changed&#xa;  - File metadata&#xa;&#xa;• Enables rollback to&#xa;  any previous version&#xa;&#xa;• Can download any&#xa;  version's CSV&#xa;&#xa;• Useful for audit&#xa;  and compliance" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="890" y="275" width="160" height="175" as="geometry" />
        </mxCell>
        
        <!-- Version Info -->
        <mxCell id="info-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;align=left;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="880" y="480" width="180" height="190" as="geometry" />
        </mxCell>
        
        <mxCell id="info-title" value="Version Details:" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="890" y="490" width="160" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="info-text" value="Each version shows:&#xa;&#xa;• Version ID (S3)&#xa;• Timestamp&#xa;• User email&#xa;• Row count&#xa;• Permission count&#xa;• File size&#xa;• Checksum&#xa;• Status:&#xa;  - Current (active)&#xa;  - Previous&#xa;  - Archived&#xa;&#xa;Sorted newest first" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="890" y="515" width="160" height="145" as="geometry" />
        </mxCell>
        
        <!-- Use Cases -->
        <mxCell id="usecase-box" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;align=left;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="250" y="480" width="180" height="190" as="geometry" />
        </mxCell>
        
        <mxCell id="usecase-title" value="Common Use Cases:" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontStyle=1;fontSize=12;" vertex="1" parent="1">
          <mxGeometry x="260" y="490" width="160" height="20" as="geometry" />
        </mxCell>
        
        <mxCell id="usecase-text" value="1. AUDIT&#xa;   Track who changed&#xa;   what and when&#xa;&#xa;2. ROLLBACK&#xa;   Restore previous&#xa;   version if needed&#xa;&#xa;3. COMPARE&#xa;   See what changed&#xa;   between versions&#xa;&#xa;4. DOWNLOAD&#xa;   Get CSV of any&#xa;   past version&#xa;&#xa;5. COMPLIANCE&#xa;   Maintain change log" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=top;whiteSpace=wrap;rounded=0;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="260" y="515" width="160" height="145" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
